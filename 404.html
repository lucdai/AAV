<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Redirecting...</title>
    <script>
        (async function() {
            const path = window.location.pathname;
            const parts = path.split('/').filter(Boolean);
            // Link format: /AAV/s/<shortId>
            // parts might be ['AAV', 's', 'shortId'] or ['s', 'shortId'] depending on base URL
            const sIndex = parts.indexOf('s');
            const shortId = (sIndex !== -1 && parts[sIndex + 1]) ? parts[sIndex + 1] : null;

            if (shortId) {
                try {
                    const response = await fetch('/AAV/shorts.json');
                    if (response.ok) {
                        const map = await response.json();
                        const longShare = map[shortId];
                        if (longShare) {
                            window.location.replace('/AAV/#share=' + encodeURIComponent(longShare));
                            return;
                        }
                    }
                } catch (e) {
                    console.error('Redirect error:', e);
                }
            }
            // Fallback to home
            window.location.replace('/AAV/');
        })();
    </script>
</head>
<body>
    Redirecting...
</body>
</html>
